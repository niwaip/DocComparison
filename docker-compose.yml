services:
  # redis:
  #   image: redis:7-alpine
  #   ports:
  #     - "6379:6379"

  backend:
    build:
      context: ./backend
      args:
        PYTHON_IMAGE: swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/python:3.11-slim
    expose:
      - "8000"
    environment:
      # REDIS_URL: redis://redis:6379
      LLM_PROVIDER: ${LLM_PROVIDER:-}
      LLM_API_KEY: ${LLM_API_KEY:-}
      LLM_BASE_URL: ${LLM_BASE_URL:-}
      LLM_MODEL: ${LLM_MODEL:-}
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
      OPENAI_BASE_URL: ${OPENAI_BASE_URL:-}
      OPENAI_MODEL: ${OPENAI_MODEL:-}
      SILICONFLOW_API_KEY: ${SILICONFLOW_API_KEY:-}
      SILICONFLOW_BASE_URL: ${SILICONFLOW_BASE_URL:-}
      SILICONFLOW_MODEL: ${SILICONFLOW_MODEL:-}
      QWEN_API_KEY: ${QWEN_API_KEY:-}
      QWEN_BASE_URL: ${QWEN_BASE_URL:-}
      QWEN_MODEL: ${QWEN_MODEL:-}
      DOC_COMPARISON_DATA_DIR: /app/data
      # Add other env vars as needed
    volumes:
      - ./backend/app:/app/app
      - ./backend/data:/app/data
    # depends_on:
    #   - redis

  frontend:
    build:
      context: ./frontend
    ports:
      - "${FRONTEND_PORT:-80}:80"
    depends_on:
      - backend

volumes:
  artifacts:
